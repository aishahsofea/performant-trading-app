# Story 1.1: Project Setup and Performance Monitoring Foundation

## Status

Approved

## Story

**As a** performance optimization learner,
**I want** a Next.js project with comprehensive performance monitoring setup,
**so that** I can measure and track improvements throughout my optimization journey.

## Acceptance Criteria

1. Next.js 14+ project initialized with App Router and TypeScript configuration
2. Lighthouse CI integrated into development workflow with automated reporting
3. Custom Core Web Vitals tracking implemented with real-time dashboard display
4. Performance budget configuration established with baseline thresholds
5. Bundle analyzer integration for tracking JavaScript bundle sizes
6. Chrome DevTools Performance timeline automation for consistent testing
7. WebPageTest API integration for external performance validation
8. Development environment includes performance profiling tools and hot reloading

## Tasks / Subtasks

- [x] Initialize Next.js 14+ project with TypeScript (AC: 1)
  - [x] Run `create-next-app@latest` with TypeScript and App Router
  - [x] Configure TypeScript 5.3.3 as specified in tech stack
  - [x] Set up initial project structure following monorepo pattern
- [x] Set up Lighthouse CI integration (AC: 2)
  - [x] Install and configure Lighthouse CI package
  - [x] Create lighthouse configuration file with performance budgets
  - [x] Set up automated Lighthouse reports in development workflow
- [x] Implement Core Web Vitals tracking (AC: 3)
  - [x] Install and configure Vercel Analytics for real-time monitoring
  - [x] Create custom performance metrics collection system
  - [x] Set up real-time dashboard display for Core Web Vitals
- [x] Configure performance budgets and thresholds (AC: 4)
  - [x] Define baseline performance thresholds for each phase
  - [x] Set up performance budget enforcement in build process
  - [x] Create performance regression detection system
- [x] Integrate bundle analyzer (AC: 5)
  - [x] Install and configure Webpack Bundle Analyzer
  - [x] Set up bundle size tracking and reporting
  - [x] Create foundation for Bundle Size Solar System visualization
- [x] Set up Chrome DevTools automation (AC: 6)
  - [x] Configure automated performance timeline capture
  - [x] Create consistent testing environment and procedures
  - [x] Set up performance profiling data collection
- [BLOCKED] Integrate WebPageTest API (AC: 7) - Requires paid subscription
  - [BLOCKED] Set up WebPageTest API integration
  - [BLOCKED] Configure external performance validation
  - [BLOCKED] Create external performance reporting system
- [x] Configure development environment (AC: 8)
  - [x] Set up hot reloading with performance monitoring
  - [x] Install and configure performance profiling tools
  - [x] Create development workflow with performance insights

## Dev Notes

### Previous Story Insights

This is the first story, so no previous insights available.

### Architecture Context

**Repository Structure**: Monorepo with Turborepo for build optimization and bundle analysis integration [Source: architecture/high-level-architecture.md#repository-structure]

```
trading-platform/
├── apps/
│   ├── web/                    # Next.js 14+ trading platform
│   └── api/                    # Standalone API services (optional)
├── packages/
│   ├── ui/                     # Shared component library
│   ├── trading-core/           # Trading logic and calculations
│   ├── performance-tools/      # Bundle analysis and optimization tools
│   └── shared/                 # Common utilities and types
```

**Platform and Infrastructure**: Vercel + Supabase + Upstash for optimal Next.js integration and real-time performance [Source: architecture/high-level-architecture.md#platform-and-infrastructure-choice]

- **Vercel**: Edge deployment, performance insights, bundle analysis integration
- **Supabase**: PostgreSQL + real-time subscriptions for portfolio and social features
- **Upstash Redis**: High-performance caching for market data and session management

### Technology Stack Details

**Frontend Framework**: Next.js 14.0.4 with App Router - Built-in performance optimization features align perfectly with learning objectives [Source: architecture/tech-stack.md#technology-stack-table]

**Build Tools**:

- Turbo 1.11.0 for monorepo build optimization - Essential for Bundle Size Solar System development [Source: architecture/tech-stack.md#technology-stack-table]
- Webpack 5.89.0 for JavaScript bundling via Next.js - Bundle analysis integration for Solar System visualization [Source: architecture/tech-stack.md#technology-stack-table]

**Monitoring**: Vercel Analytics + Custom monitoring - Essential for learning objectives and Core Web Vitals optimization [Source: architecture/tech-stack.md#technology-stack-table]

**Testing**:

- Vitest 1.1.0 + Testing Library 14.0.0 for component testing
- Playwright 1.40.0 for E2E testing with performance monitoring integration [Source: architecture/tech-stack.md#technology-stack-table]

### Deployment and Infrastructure

**IaC Tool**: Vercel CLI 32.0.0 for simplified deployment with performance insights integration [Source: architecture/tech-stack.md#technology-stack-table]

**CI/CD**: GitHub Actions for performance regression testing and bundle analysis automation [Source: architecture/tech-stack.md#technology-stack-table]

### Architectural Patterns

**Hybrid Rendering Pattern**: Strategic Server/Client Component separation for optimal trading performance [Source: architecture/high-level-architecture.md#architectural-patterns]

**Progressive Enhancement Pattern**: Performance learning features enhance core trading without blocking functionality [Source: architecture/high-level-architecture.md#architectural-patterns]

### File Locations

Based on the repository structure, new code should be created in:

- Main application: `apps/web/`
- Performance tools: `packages/performance-tools/`
- Shared utilities: `packages/shared/`
- UI components: `packages/ui/`

### Technical Constraints

**TypeScript Version**: 5.3.3 - Essential for complex financial calculations and Bundle Size Solar System 3D interactions [Source: architecture/tech-stack.md#technology-stack-table]

**Performance Budget**: Baseline thresholds must be established for the six optimization phases mentioned in the technical summary [Source: architecture/high-level-architecture.md#technical-summary]

### Project Structure Notes

The architecture references several files that don't exist yet (coding-standards.md, source-tree.md, testing-strategy.md). These will need to be created in subsequent stories or as part of this foundation setup.

### Testing

**Testing Standards**:

- Vitest + Testing Library for component and integration testing - Fast testing aligned with performance optimization learning [Source: architecture/tech-stack.md#technology-stack-table]
- Playwright for end-to-end testing with performance monitoring integration [Source: architecture/tech-stack.md#technology-stack-table]
- Unified testing framework across fullstack application [Source: architecture/tech-stack.md#technology-stack-table]

**Test File Locations**: No specific guidance found in architecture docs

**Testing Requirements**: Performance regression testing and bundle analysis automation should be integrated into CI/CD [Source: architecture/tech-stack.md#technology-stack-table]

## Change Log

| Date  | Version | Description                                                                    | Author             |
| ----- | ------- | ------------------------------------------------------------------------------ | ------------------ |
| Today | 1.0     | Initial story creation for project setup and performance monitoring foundation | Bob (Scrum Master) |

## Dev Agent Record

_This section will be populated by the development agent during implementation_

### Agent Model Used

Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References

- Performance regression detection system implemented successfully
- Baseline metrics created: 385KB JS, 17KB CSS, 402KB Total
- Regression thresholds configured based on performance budgets
- WebPageTest API integration BLOCKED: requires paid subscription plan
- WebPageTest infrastructure prepared (package installed, environment configured)

### Completion Notes List

- Implemented comprehensive performance regression detection system in `apps/dashboard/src/scripts/performanceRegressionCheck.ts`
- Added historical performance data storage in `.performance-history/` directory
- Created regression comparison logic with configurable thresholds (10% JS/CSS, 5% total size)
- Added npm scripts for regression checking: `performance:regression-check` and `performance:regression-baseline`
- System successfully detects regressions, improvements, and maintains baseline history
- Configured Webpack Bundle Analyzer with @next/bundle-analyzer for visual bundle composition analysis
- Bundle size tracking implemented through existing performance monitoring system (performanceBudgetCheck.ts and performanceRegressionCheck.ts)
- Bundle reporting available through HTML analyzer reports (.next/analyze/) and performance regression reports
- **WebPageTest API integration BLOCKED**: Requires paid subscription plan for API access
- WebPageTest infrastructure prepared: package installed (webpagetest@0.7.6), environment variables configured
- Created integration plan document with phases and requirements documentation

### File List

- `apps/dashboard/src/scripts/performanceRegressionCheck.ts` - Main regression detection implementation
- `apps/dashboard/package.json` - Added regression check npm scripts
- `apps/dashboard/.performance-history/` - Directory for storing historical metrics

## QA Results

_Results from QA Agent review will be added here after implementation_
